map $http_x_test_header $is_allowed {
    default       0;
    'ATestHeaderFromClient' 1;
}

server {
    listen 80;
    server_name testimgsrv;
    root /usr/share/nginx/html;
    add_header X-Special-Header "Special Value";

    location / {
        try_files $uri $uri/ =404;
    }

    location /error {
        return 500;
    }

    location /check-header {
        if ($is_allowed = 0) {
                return 403;  # Forbidden, or use 404 for Not Found, etc.
        }
        try_files /gopher_50x50.jpg =404;
    }

}